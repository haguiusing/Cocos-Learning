{"version":3,"sources":["file:///G:/CocosProjects/Cocos-Learning/assets/Scripts/Cocos%E5%9F%BA%E7%A1%80/%E8%84%9A%E6%9C%AC%E6%8C%87%E5%8D%97%E5%8F%8A%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6/%E8%84%9A%E6%9C%AC%E4%BD%BF%E7%94%A8/Lesson09_.ts"],"names":["_decorator","Component","director","Node","assetManager","ccclass","property","Lesson09_","switchScene","sceneName","loadScene","switchSceneByBundle","bundleName","bundle","getBundle","err","sceneAsset","console","error","runScene","switchWithCallback","targetScene","onSceneLaunched","bind","log","preload","preloadScene","loadPreloaded","makePersist","persistNode","parent","addPersistRootNode","removePersist","removePersistRootNode","start","onDestroy"],"mappings":";;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,I,OAAAA,I;AAAoBC,MAAAA,Y,OAAAA,Y;;;;;iFAD9D;;;;;OAEM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;AAE9B;AACA;AACA;AACA;;2BAEaO,S,WADZF,OAAO,CAAC,WAAD,C,UAoDHC,QAAQ,CAACH,IAAD,C,2BApDb,MACaI,SADb,SAC+BN,SAD/B,CACyC;AAAA;AAAA;;AA+CrC;;AAEA;AACA;AAlDqC;AAAA;;AAErC;AACA;AACQO,QAAAA,WAAW,CAACC,SAAD,EAAoB;AACnCP,UAAAA,QAAQ,CAACQ,SAAT,CAAmBD,SAAnB;AACH,SANoC,CAOrC;;AAEA;AACA;;;AACQE,QAAAA,mBAAmB,CAACC,UAAD,EAAqBH,SAArB,EAAwC;AAC/D,gBAAMI,MAAM,GAAGT,YAAY,CAACU,SAAb,CAAuBF,UAAvB,CAAf;AACA,cAAI,CAACC,MAAL,EAAa;AAEbA,UAAAA,MAAM,CAACH,SAAP,CAAiBD,SAAjB,EAA4B,CAACM,GAAD,EAAMC,UAAN,KAAqB;AAC7C,gBAAID,GAAJ,EAAS;AACLE,cAAAA,OAAO,CAACC,KAAR,CAAcH,GAAd;AACA;AACH;;AACDb,YAAAA,QAAQ,CAACiB,QAAT,CAAkBH,UAAlB;AACH,WAND;AAOH,SAtBoC,CAuBrC;;AAEA;AACA;;;AACQI,QAAAA,kBAAkB,CAACC,WAAD,EAAsB;AAC5CnB,UAAAA,QAAQ,CAACQ,SAAT,CAAmBW,WAAnB,EAAgC,KAAKC,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,CAAhC;AACH;;AAEOD,QAAAA,eAAe,GAAG;AACtBL,UAAAA,OAAO,CAACO,GAAR,CAAY,oCAAZ;AACH,SAjCoC,CAkCrC;;AAEA;AACA;;;AACQC,QAAAA,OAAO,CAACJ,WAAD,EAAsB;AACjCnB,UAAAA,QAAQ,CAACwB,YAAT,CAAsBL,WAAtB,EAAmC,MAAM;AACrCJ,YAAAA,OAAO,CAACO,GAAR,CAAa,GAAEH,WAAY,YAA3B;AACH,WAFD;AAGH;;AAEOM,QAAAA,aAAa,CAACN,WAAD,EAAsB;AACvCnB,UAAAA,QAAQ,CAACQ,SAAT,CAAmBW,WAAnB;AACH;;AAM4B;AAErBO,QAAAA,WAAW,GAAG;AAClB,cAAI,KAAKC,WAAL,IAAoB,KAAKA,WAAL,CAAiBC,MAAjB,KAA4B,IAApD,EAA0D;AACtD5B,YAAAA,QAAQ,CAAC6B,kBAAT,CAA4B,KAAKF,WAAjC;AACAZ,YAAAA,OAAO,CAACO,GAAR,CAAY,wBAAZ;AACH;AACJ;;AAEOQ,QAAAA,aAAa,GAAG;AACpB,cAAI,KAAKH,WAAT,EAAsB;AAClB3B,YAAAA,QAAQ,CAAC+B,qBAAT,CAA+B,KAAKJ,WAApC;AACAZ,YAAAA,OAAO,CAACO,GAAR,CAAY,mCAAZ;AACH;AACJ,SAlEoC,CAmErC;;AAEA;AACA;;;AACUU,QAAAA,KAAK,GAAG;AACd;AACA,eAAKN,WAAL;AACH;;AAESO,QAAAA,SAAS,GAAG;AAClB,eAAKH,aAAL;AACH,SA9EoC,CA+ErC;;;AA/EqC,O;;;;;iBAoDjB,I","sourcesContent":["// Lesson09_.ts\nimport { _decorator, Component, director, Node, Asset, Scene, assetManager } from 'cc';\nconst { ccclass, property } = _decorator;\n\n/**\n * 场景管理与常驻节点示例\n * 核心类：Lesson09_\n */\n@ccclass('Lesson09_')\nexport class Lesson09_ extends Component {\n\n    /* ------------------ 1. 普通场景切换 ------------------ */\n    //#region 1. 普通场景切换\n    private switchScene(sceneName: string) {\n        director.loadScene(sceneName);\n    }\n    //#endregion\n\n    /* ------------------ 2. Asset Bundle 场景 ------------------ */\n    //#region 2. Asset Bundle 场景\n    private switchSceneByBundle(bundleName: string, sceneName: string) {\n        const bundle = assetManager.getBundle(bundleName);\n        if (!bundle) return;\n\n        bundle.loadScene(sceneName, (err, sceneAsset) => {\n            if (err) {\n                console.error(err);\n                return;\n            }\n            director.runScene(sceneAsset);\n        });\n    }\n    //#endregion\n\n    /* ------------------ 3. 场景加载回调 ------------------ */\n    //#region 3. 场景加载回调\n    private switchWithCallback(targetScene: string) {\n        director.loadScene(targetScene, this.onSceneLaunched.bind(this));\n    }\n\n    private onSceneLaunched() {\n        console.log('Scene launched, do further init...');\n    }\n    //#endregion\n\n    /* ------------------ 4. 预加载场景 ------------------ */\n    //#region 4. 预加载场景\n    private preload(targetScene: string) {\n        director.preloadScene(targetScene, () => {\n            console.log(`${targetScene} preloaded`);\n        });\n    }\n\n    private loadPreloaded(targetScene: string) {\n        director.loadScene(targetScene);\n    }\n    //#endregion\n\n    /* ------------------ 5. 常驻节点 ------------------ */\n    //#region 5. 常驻节点\n    @property(Node)\n    persistNode: Node = null!;   // 在属性检查器中拖入根节点\n\n    private makePersist() {\n        if (this.persistNode && this.persistNode.parent === null) {\n            director.addPersistRootNode(this.persistNode);\n            console.log('Node set to persistent');\n        }\n    }\n\n    private removePersist() {\n        if (this.persistNode) {\n            director.removePersistRootNode(this.persistNode);\n            console.log('Node removed from persistent list');\n        }\n    }\n    //#endregion\n\n    /* ------------------ 6. 生命周期演示 ------------------ */\n    //#region 6. 生命周期\n    protected start() {\n        // 示例：把本脚本所在节点设为常驻\n        this.makePersist();\n    }\n\n    protected onDestroy() {\n        this.removePersist();\n    }\n    //#endregion\n}"]}