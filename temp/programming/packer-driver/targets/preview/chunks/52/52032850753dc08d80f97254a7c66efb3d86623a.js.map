{"version":3,"sources":["file:///G:/CocosProjects/Cocos-Learning/assets/Scripts/Cocos%E6%A0%B8%E5%BF%83/2D%20%E5%AF%B9%E8%B1%A1/2D%20%E6%B8%B2%E6%9F%93/Lesson24_.ts"],"names":["_decorator","Component","UIStaticBatch","Label","Node","ccclass","property","Lesson24_","collectStaticBatch","uiStaticBatch","markAsDirty","console","log","demoReCollect","label","parent","node","lbl","addComponent","string","scheduleOnce","start","warn","onDestroy","unscheduleAllCallbacks"],"mappings":";;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,a,OAAAA,a;AAAeC,MAAAA,K,OAAAA,K;AAAeC,MAAAA,I,OAAAA,I;;;;;iFAD9D;;;;;OAEM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;AAE9B;AACA;AACA;AACA;AACA;;2BAEaO,S,WADZF,OAAO,CAAC,WAAD,C,UAKHC,QAAQ,CAACJ,aAAD,C,2BALb,MACaK,SADb,SAC+BN,SAD/B,CACyC;AAAA;AAAA;;AAErC;AACA;AAHqC;AAAA;;AAMrC;;AAEA;AACA;AACQO,QAAAA,kBAAkB,GAAG;AACzB;AACA,eAAKC,aAAL,CAAmBC,WAAnB;AACAC,UAAAA,OAAO,CAACC,GAAR,CAAY,kCAAZ;AACH,SAdoC,CAerC;;AAEA;AACA;;;AACQC,QAAAA,aAAa,GAAG;AACpB;AACA,cAAIC,KAAK,GAAG,IAAIV,IAAJ,EAAZ;AACAU,UAAAA,KAAK,CAACC,MAAN,GAAe,KAAKC,IAApB;AACA,cAAMC,GAAG,GAAGH,KAAK,CAACI,YAAN,CAAmBf,KAAnB,CAAZ;AACAc,UAAAA,GAAG,CAACE,MAAJ,GAAa,QAAb,CALoB,CAOpB;;AACA,eAAKC,YAAL,CAAkB,MAAM,KAAKZ,kBAAL,EAAxB,EAAmD,GAAnD;AACH,SA5BoC,CA6BrC;;AAEA;AACA;;;AACUa,QAAAA,KAAK,GAAG;AACd,cAAI,CAAC,KAAKZ,aAAV,EAAyB;AACrBE,YAAAA,OAAO,CAACW,IAAR,CAAa,gCAAb;AACA;AACH;;AACD,eAAKd,kBAAL,GALc,CAMd;;AACA,eAAKY,YAAL,CAAkB,KAAKP,aAAvB,EAAsC,CAAtC;AACH;;AAESU,QAAAA,SAAS,GAAG;AAClB,eAAKC,sBAAL;AACH,SA7CoC,CA8CrC;;;AA9CqC,O;;;;;iBAKN,I","sourcesContent":["// Lesson24_.ts\nimport { _decorator, Component, UIStaticBatch, Label, Sprite, Node } from 'cc';\nconst { ccclass, property } = _decorator;\n\n/**\n * UIStaticBatch 静态合批示例\n * 核心类：Lesson24_\n * 注意：v3.4.1 起官方已不推荐手动使用此组件，未来会移除\n */\n@ccclass('Lesson24_')\nexport class Lesson24_ extends Component {\n\n    /* ------------------ 1. 组件声明 ------------------ */\n    //#region 1. 组件声明\n    @property(UIStaticBatch)\n    uiStaticBatch: UIStaticBatch = null!;\n    //#endregion\n\n    /* ------------------ 2. 收集静态合批数据 ------------------ */\n    //#region 2. 收集数据\n    private collectStaticBatch() {\n        // 必须在子节点全部摆放完成后调用一次\n        this.uiStaticBatch.markAsDirty();\n        console.log('UIStaticBatch 已采集静态数据，后续子节点改动将无效');\n    }\n    //#endregion\n\n    /* ------------------ 3. 动态演示：添加精灵后重采 ------------------ */\n    //#region 3. 动态演示\n    private demoReCollect() {\n        // 示例：运行时新增一个 Label 作为子节点\n        let label = new Node();\n        label.parent = this.node;\n        const lbl = label.addComponent(Label);\n        lbl.string = 'Static';\n\n        // 重新采集一次（不推荐频繁调用）\n        this.scheduleOnce(() => this.collectStaticBatch(), 0.1);\n    }\n    //#endregion\n\n    /* ------------------ 4. 生命周期 ------------------ */\n    //#region Lifecycle\n    protected start() {\n        if (!this.uiStaticBatch) {\n            console.warn('请先在编辑器里给根节点添加 UIStaticBatch 组件');\n            return;\n        }\n        this.collectStaticBatch();\n        // 演示：2 秒后动态添加节点并重采\n        this.scheduleOnce(this.demoReCollect, 2);\n    }\n\n    protected onDestroy() {\n        this.unscheduleAllCallbacks();\n    }\n    //#endregion\n}"]}